import json
import numpy as np
import hdbscan
from scipy.spatial.distance import cosine
from sklearn.preprocessing import StandardScaler
from sklearn.metrics.pairwise import cosine_similarity

"""
    A class used to filter and cluster triples of (entity1, context, entity2) based on various scoring metrics and embedding similarities.

    Attributes
    ----------
    score_threshold : float
        The minimum score that both entities in a triple must have to be considered relevant.
    attention_score_threshold : float
        The minimum attention score that a triple must have to be considered relevant.
    similarity_threshold : float
        The minimum cosine similarity score between the embeddings of the entities to be considered relevant.
    min_cluster_size : int
        The minimum size of clusters to be formed by the HDBSCAN clustering algorithm.
    min_samples : int
        The number of samples in a neighborhood for a point to be considered a core point.

    Methods
    -------
    calculate_cosine_similarity(embedding1, embedding2):
        Calculates the cosine similarity between two embeddings.

    filter_by_score(data):
        Filters triples by checking if the entity scores meet the score threshold.

    filter_by_attention_score(data):
        Filters triples by checking if the pair attention score meets the attention score threshold.

    filter_by_embedding_similarity(data):
        Filters triples by checking if the cosine similarity between entity embeddings meets the similarity threshold.

    filter_triples(triples):
        Filters a list of triples by applying score, attention score, and embedding similarity filters.

    combine_embeddings(entity1_embedding, entity2_embedding):
        Combines two entity embeddings into a single embedding.

    cluster_triples(triples):
        Clusters the filtered triples using the HDBSCAN algorithm and returns the clusters along with the reduction count and the clusterer instance.

    Notes
    -----
    - The class expects triples in the form of (entity1, context, entity2), where 'context' is a JSON string containing various attributes including the embeddings.
    - The embeddings are expected to be in a format that can be converted to numpy arrays.
    - The class is designed to be flexible and allows for customization of the clustering process through various parameters.
"""

class TripleFilter:
    def __init__(self, score_threshold, attention_score_threshold, similarity_threshold, min_cluster_size=2, min_samples=None):
        self.score_threshold = score_threshold
        self.attention_score_threshold = attention_score_threshold
        self.similarity_threshold = similarity_threshold
        self.min_cluster_size = min_cluster_size
        self.min_samples = min_samples if min_samples is not None else self.min_cluster_size

    @staticmethod
    def calculate_cosine_similarity(embedding1, embedding2):
        try:
            embedding1 = np.asarray(embedding1)
            embedding2 = np.asarray(embedding2)
            if embedding1.ndim == 1:
                embedding1 = embedding1.reshape(1, -1)
            if embedding2.ndim == 1:
                embedding2 = embedding2.reshape(1, -1)
            if embedding1.shape[1] != embedding2.shape[1]:
                raise ValueError("Embeddings must have the same length")
            
            return cosine_similarity(embedding1, embedding2)[0, 0]
        
        except Exception as e:
            raise(f"Error calculating cosine similarity: {e}")


    def filter_by_score(self, data):
        try:
            return (data['entity1_score'] >= self.score_threshold and
                    data['entity2_score'] >= self.score_threshold)
            
        except KeyError as e:
            raise(f"Missing score in data: {e}")


    def filter_by_attention_score(self, data):
        try:
            print(data['pair_attnscore'])
            return (data['pair_attnscore'] >= self.attention_score_threshold)
        
        except KeyError as e:
            raise(f"Missing attention score in data: {e}")
            
    def filter_by_embedding_similarity(self, data):
        try:
            similarity = self.calculate_cosine_similarity(data['entity1_embedding'], data['entity2_embedding'])
            
            return similarity >= self.similarity_threshold
        
        except Exception as e:
            raise(f"Error filtering by embedding similarity: {e}")

    def cosine_distance(u, v):
    
        return cosine(u, v)
    
    def filter_triples(self, triples):
        relevant_triples = []
        initial_count = len(triples)
        for triple in triples:
            try:
                entity1, json_data, entity2 = triple
                print(entity1, entity2)
                data = json.loads(json_data)
                
                if not self.filter_by_score(data):
                    print("score filetered")
                    continue
                if not self.filter_by_attention_score(data):
                    print("attn score filtered")
                    continue
                if not self.filter_by_embedding_similarity(data):
                    print("embedding similarity fileterd")
                    continue
                
                relevant_triples.append(triple)
            except (json.JSONDecodeError, KeyError) as e:
                raise(f"Error processing triple: {e}")
        reduction_count = initial_count - len(relevant_triples)
        
        return relevant_triples, reduction_count

    def combine_embeddings(self, entity1_embedding, entity2_embedding):
        try:
        
            return np.concatenate((entity1_embedding, entity2_embedding))
        
        except Exception as e:
            raise(f"Error combining embeddings: {e}")
            
    def cluster_triples(self, triples):
        try:
            combined_embeddings = np.array([
                self.combine_embeddings(
                    json.loads(triple[1])['entity1_embedding'],
                    json.loads(triple[1])['entity2_embedding']
                ) for triple in triples
            ])
            scaler = StandardScaler()
            normalized_embeddings = scaler.fit_transform(combined_embeddings)
            clusterer = hdbscan.HDBSCAN(metric=TripleFilter.cosine_distance, min_cluster_size=self.min_cluster_size, min_samples=self.min_samples, cluster_selection_method="leaf")
            cluster_labels = clusterer.fit_predict(normalized_embeddings)
            initial_count = len(triples)
            clustered_triples = list(zip(triples, cluster_labels))
            filtered_triples = [triple for triple, label in clustered_triples if label != -1]
            reduction_count = initial_count - len(filtered_triples)
            
            return filtered_triples, reduction_count, clusterer
        
        except Exception as e:
            raise(f"Error during clustering: {e}")




# Sample usage
# triples = [('eocene', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM.", "entity1_score": 1.0, "entity2_score": 0.69, "entity1_label": "B-GeoTime, B-GeoMeth", "entity2_label": "B-GeoMeth", "entity1_nn_chunk": "a Paleocene\\u2013Eocene Thermal Maximum (PETM) record", "entity2_nn_chunk": "a 543-m-thick (1780 ft) deep-marine section", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.2, "entity2_attnscore": 0.09, "pair_attnscore": 0.12, "entity1_embedding": [5.806029319763184, 4.711646556854248, 10.007149696350098, -3.0313189029693604, 0.8175665140151978, 4.75740909576416, 3.2859764099121094, 7.10709810256958, 5.6952080726623535, -1.237688660621643], "entity2_embedding": [5.406210422515869, 4.236902713775635, 10.823274612426758, -3.0907862186431885, 0.8117231130599976, 5.029420852661133, 3.561847448348999, 6.808368682861328, 6.641637325286865, 0.5979641675949097], "sentence_embedding": [5.861782073974609, 5.489847183227539, 6.995452404022217, 6.426591873168945, 7.025845050811768, 4.33557653427124, 1.1677730083465576, 2.223400354385376, 9.690017700195312, 6.321086406707764]}', 'ft'), 
#            ('eocene', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM.", "entity1_score": 1.0, "entity2_score": 0.92, "entity1_label": "B-GeoTime, B-GeoMeth", "entity2_label": "B-GeoLoc", "entity1_nn_chunk": "a Paleocene\\u2013Eocene Thermal Maximum (PETM) record", "entity2_nn_chunk": "Mexico", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.2, "entity2_attnscore": 0.09, "pair_attnscore": 0.13, "entity1_embedding": [5.984417915344238, 4.448272705078125, 10.041189193725586, -3.3808908462524414, 0.5530117750167847, 4.75883674621582, 3.10871958732605, 7.164763927459717, 5.174183368682861, -0.9852765202522278], "entity2_embedding": [6.14603853225708, 4.238102436065674, 11.094611167907715, -2.342019557952881, 0.6067559123039246, 5.4673542976379395, 3.9664976596832275, 6.905603885650635, 4.893499374389648, 0.8242766857147217], "sentence_embedding": [5.9295196533203125, 5.422562599182129, 7.063157558441162, 6.357707977294922, 7.072486877441406, 4.290467739105225, 1.1259129047393799, 2.1787097454071045, 9.732961654663086, 6.463715553283691]}', 'mexico'), 
#            ('eocene', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM.", "entity1_score": 1.0, "entity2_score": 0.98, "entity1_label": "B-GeoTime, B-GeoMeth", "entity2_label": "B-GeoPetro, B-GeoMeth", "entity1_nn_chunk": "a Paleocene\\u2013Eocene Thermal Maximum (PETM) record", "entity2_nn_chunk": "organic carbon stable isotopes", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.2, "entity2_attnscore": 0.21, "pair_attnscore": 0.21, "entity1_embedding": [5.765657424926758, 4.715219020843506, 9.893031120300293, -3.2509071826934814, 0.5304556488990784, 4.769660472869873, 2.957357168197632, 7.162674427032471, 5.725409507751465, -1.0689209699630737], "entity2_embedding": [5.8230299949646, 3.4632456302642822, 10.974175453186035, -3.384859085083008, 0.7271181344985962, 5.368386268615723, 3.7411386966705322, 6.219064235687256, 5.724222183227539, -1.9964708089828491], "sentence_embedding": [5.968934059143066, 5.383453369140625, 7.10256290435791, 6.317614555358887, 7.1089324951171875, 4.255156517028809, 1.0913355350494385, 2.1446874141693115, 9.694925308227539, 6.239784240722656]}', 'organic'), 
#            ('ft', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM.", "entity1_score": 0.69, "entity2_score": 0.92, "entity1_label": "B-GeoMeth", "entity2_label": "B-GeoLoc", "entity1_nn_chunk": "a 543-m-thick (1780 ft) deep-marine section", "entity2_nn_chunk": "Mexico", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.09, "entity2_attnscore": 0.09, "pair_attnscore": 0.09, "entity1_embedding": [5.56234073638916, 4.269966125488281, 10.609246253967285, -2.936349630355835, 0.7112082242965698, 5.025224685668945, 3.5007200241088867, 6.966150283813477, 6.770739555358887, 0.09117458015680313], "entity2_embedding": [5.733912467956543, 4.474196910858154, 10.827674865722656, -2.0731005668640137, 0.6360260248184204, 5.305593013763428, 3.6782312393188477, 6.936079978942871, 4.7147698402404785, 0.7293659448623657], "sentence_embedding": [5.959885120391846, 5.392279148101807, 7.093533039093018, 6.326847553253174, 7.107750415802002, 4.256359100341797, 1.0944511890411377, 2.14481520652771, 9.702616691589355, 6.39816427230835]}', 'mexico'), 
#            ('ft', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM.", "entity1_score": 0.69, "entity2_score": 0.98, "entity1_label": "B-GeoMeth", "entity2_label": "B-GeoPetro, B-GeoMeth", "entity1_nn_chunk": "a 543-m-thick (1780 ft) deep-marine section", "entity2_nn_chunk": "organic carbon stable isotopes", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.09, "entity2_attnscore": 0.21, "pair_attnscore": 0.12, "entity1_embedding": [5.570370197296143, 4.071465015411377, 10.642053604125977, -3.140767812728882, 0.6224818229675293, 5.160495758056641, 3.5649473667144775, 7.131798267364502, 6.639642715454102, 0.23463283479213715], "entity2_embedding": [5.921403408050537, 3.2615835666656494, 10.81191635131836, -3.460866928100586, 0.658799946308136, 5.505590438842773, 3.466254234313965, 6.091804027557373, 5.5349650382995605, -1.5452433824539185], "sentence_embedding": [5.9112982749938965, 5.440462589263916, 7.044966220855713, 6.376270771026611, 7.070584297180176, 4.292366027832031, 1.1292659044265747, 2.179736375808716, 9.651530265808105, 6.266529560089111]}', 'organic'), 
#            ('mexico', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM.", "entity1_score": 0.92, "entity2_score": 0.98, "entity1_label": "B-GeoLoc", "entity2_label": "B-GeoPetro, B-GeoMeth", "entity1_nn_chunk": "Mexico", "entity2_nn_chunk": "organic carbon stable isotopes", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.09, "entity2_attnscore": 0.21, "pair_attnscore": 0.13, "entity1_embedding": [5.570857524871826, 4.2779316902160645, 10.888934135437012, -2.544783353805542, 0.482151597738266, 5.3470845222473145, 3.7484028339385986, 6.86525821685791, 4.764354228973389, 0.8943160176277161], "entity2_embedding": [5.672744274139404, 3.566399574279785, 11.169869422912598, -3.376610517501831, 0.7470220923423767, 5.382347583770752, 3.507796049118042, 6.109884738922119, 5.774186134338379, -2.0476856231689453], "sentence_embedding": [5.941858768463135, 5.41019344329834, 7.075500965118408, 6.345186233520508, 7.092735767364502, 4.27089786529541, 1.1080917119979858, 2.15913987159729, 9.649893760681152, 6.304165363311768]}', 'organic'), 
#            ('tectonic', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoMeth", "entity1_nn_chunk": "tectonic perturbations", "entity2_nn_chunk": "the upstream North American catchments", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.25, "entity2_attnscore": 0.11, "pair_attnscore": 0.15, "entity1_embedding": [5.227938175201416, 3.557138442993164, 11.902892112731934, -2.728647232055664, 0.23569585382938385, 5.84645414352417, 4.170116424560547, 5.410197734832764, 4.782535076141357, -1.2884552478790283], "entity2_embedding": [4.237706661224365, 4.327345371246338, 10.717799186706543, -3.085191488265991, 0.18781696259975433, 4.985228061676025, 3.0504913330078125, 6.168115615844727, 6.343464374542236, -0.6117480397224426], "sentence_embedding": [5.998215675354004, 5.353236198425293, 7.131946563720703, 6.288086414337158, 7.172060489654541, 4.194421768188477, 1.0464892387390137, 2.078491687774658, 12.253105163574219, 3.528350353240967]}', 'upstream'), 
#            ('tectonic', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "tectonic perturbations", "entity2_nn_chunk": "the downstream sectors", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.25, "entity2_attnscore": 0.49, "pair_attnscore": 0.33, "entity1_embedding": [5.134824752807617, 3.557403326034546, 11.958061218261719, -2.950269937515259, 0.3490438163280487, 5.721531391143799, 4.278126239776611, 5.596852779388428, 4.6679511070251465, -1.3759851455688477], "entity2_embedding": [5.42916202545166, 3.5697226524353027, 11.787546157836914, -2.4457180500030518, 0.6080585718154907, 5.807782173156738, 3.683560371398926, 5.894649505615234, 6.0415239334106445, -1.9194401502609253], "sentence_embedding": [5.944714069366455, 5.406009674072266, 7.078484535217285, 6.342588901519775, 7.167598724365234, 4.198736190795898, 1.0504140853881836, 2.0828027725219727, 12.072354316711426, 3.4205410480499268]}', 'downstream'), 
#            ('tectonic', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin.", "entity1_score": 1.0, "entity2_score": 0.98, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "tectonic perturbations", "entity2_nn_chunk": "the Gulf Coastal Plain", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.25, "entity2_attnscore": 0.24, "pair_attnscore": 0.24, "entity1_embedding": [5.060394763946533, 3.372471809387207, 11.696398735046387, -2.924064874649048, 0.1889059990644455, 5.819956302642822, 4.2589216232299805, 5.592936038970947, 4.6155619621276855, -1.4657464027404785], "entity2_embedding": [5.885555267333984, 4.063122272491455, 12.182744026184082, -2.746405601501465, 1.1505061388015747, 5.211516857147217, 4.004940509796143, 6.814065933227539, 6.1178107261657715, 0.1607671082019806], "sentence_embedding": [5.931403636932373, 5.419116973876953, 7.065196990966797, 6.356155872344971, 7.134998321533203, 4.230473518371582, 1.0861246585845947, 2.110921621322632, 11.978755950927734, 3.44460129737854]}', 'coastal'), 
#            ('upstream', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoMeth", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "the upstream North American catchments", "entity2_nn_chunk": "the downstream sectors", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.11, "entity2_attnscore": 0.49, "pair_attnscore": 0.18, "entity1_embedding": [4.811859130859375, 4.164788722991943, 11.047094345092773, -2.8092145919799805, 0.7352932691574097, 5.13606071472168, 3.4754815101623535, 6.105210781097412, 6.811580181121826, -0.5093387365341187], "entity2_embedding": [5.2327446937561035, 3.187808036804199, 11.634462356567383, -2.1691319942474365, 0.3646335303783417, 6.072718143463135, 3.669523239135742, 5.929037570953369, 5.536008358001709, -1.4828662872314453], "sentence_embedding": [5.992631912231445, 5.358750343322754, 7.126368999481201, 6.293790340423584, 7.169031143188477, 4.197372913360596, 1.049765706062317, 2.0811307430267334, 12.186680793762207, 3.488616466522217]}', 'downstream'), 
#            ('upstream', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin.", "entity1_score": 1.0, "entity2_score": 0.98, "entity1_label": "B-GeoMeth", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "the upstream North American catchments", "entity2_nn_chunk": "the Gulf Coastal Plain", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.11, "entity2_attnscore": 0.24, "pair_attnscore": 0.15, "entity1_embedding": [4.617306709289551, 4.134646892547607, 11.017990112304688, -2.6618072986602783, 0.623265266418457, 5.233328819274902, 3.329355239868164, 5.881094932556152, 6.438699722290039, -0.5615249872207642], "entity2_embedding": [5.7367448806762695, 4.187161445617676, 12.124628067016602, -2.5960545539855957, 1.1292005777359009, 5.185882568359375, 3.988959550857544, 6.7633256912231445, 6.339499473571777, 0.3039853870868683], "sentence_embedding": [5.973137378692627, 5.3780083656311035, 7.106877326965332, 6.313648700714111, 7.154751300811768, 4.211243629455566, 1.0646365880966187, 2.0938072204589844, 12.084132194519043, 3.457716226577759]}', 'coastal'), 
#            ('downstream', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin.", "entity1_score": 1.0, "entity2_score": 0.98, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "the downstream sectors", "entity2_nn_chunk": "the Gulf Coastal Plain", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.49, "entity2_attnscore": 0.24, "pair_attnscore": 0.32, "entity1_embedding": [5.155695915222168, 3.551076889038086, 11.811562538146973, -2.2679989337921143, 0.4109173119068146, 5.8665313720703125, 3.870582103729248, 5.805659770965576, 5.633402347564697, -1.8210735321044922], "entity2_embedding": [5.638219833374023, 4.087839126586914, 12.285836219787598, -2.664782762527466, 1.1524254083633423, 5.254331588745117, 4.099677085876465, 6.621889591217041, 6.104891777038574, 0.5493454933166504], "sentence_embedding": [6.040095329284668, 5.312082767486572, 7.173774719238281, 6.245410919189453, 7.190678596496582, 4.17625617980957, 1.0243538618087769, 2.063288927078247, 12.189994812011719, 3.457150936126709]}', 'coastal'), 
#            ('basin', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "the GoM basin", "entity2_nn_chunk": "deposition", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.26, "entity2_attnscore": 0.26, "pair_attnscore": 0.26, "entity1_embedding": [5.632567882537842, 3.745913505554199, 12.488518714904785, -1.8180503845214844, 1.4627394676208496, 5.558170318603516, 3.9610276222229004, 5.745853424072266, 4.740311622619629, -0.9180778861045837], "entity2_embedding": [5.8035502433776855, 3.358166217803955, 11.828393936157227, -2.338801145553589, 0.7177625298500061, 5.654134750366211, 4.4361491203308105, 6.141598224639893, 5.0417585372924805, -2.0096747875213623], "sentence_embedding": [6.463963031768799, 4.894571781158447, 7.597216606140137, 5.813544273376465, 7.416733264923096, 3.956239938735962, 0.7759601473808289, 1.8687992095947266, 13.310980796813965, 4.445505619049072]}', 'deposition'), 
#            ('basin', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "the GoM basin", "entity2_nn_chunk": "a shale interval", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.26, "entity2_attnscore": 0.1, "pair_attnscore": 0.14, "entity1_embedding": [5.752685546875, 3.869178295135498, 12.118419647216797, -1.6711852550506592, 1.0017861127853394, 5.658951759338379, 4.051663875579834, 5.838469505310059, 4.696285247802734, -0.7191007733345032], "entity2_embedding": [5.989519119262695, 3.841844320297241, 12.594922065734863, -2.1688992977142334, 1.4477449655532837, 5.582550525665283, 3.8531200885772705, 5.966081142425537, 4.652071475982666, -1.621478796005249], "sentence_embedding": [6.467498302459717, 4.891037464141846, 7.600748538970947, 5.809948444366455, 7.41684627532959, 3.956146240234375, 0.7763484120368958, 1.8684546947479248, 13.316513061523438, 4.4112138748168945]}', 'shale'), 
#            ('basin', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "the GoM basin", "entity2_nn_chunk": "coarse-grained terrigenous material", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.26, "entity2_attnscore": 0.05, "pair_attnscore": 0.09, "entity1_embedding": [5.846540927886963, 3.8652660846710205, 12.205229759216309, -1.846346378326416, 1.1860523223876953, 5.620425224304199, 3.912438154220581, 5.919673442840576, 4.923732757568359, -0.6932424902915955], "entity2_embedding": [6.040987014770508, 3.255516529083252, 12.355816841125488, -3.348207712173462, 1.2182426452636719, 5.326868534088135, 4.170299053192139, 6.002001762390137, 5.250322341918945, -1.3677003383636475], "sentence_embedding": [6.588249206542969, 4.771914958953857, 7.721395969390869, 5.686972618103027, 7.484442710876465, 3.890435218811035, 0.7052521109580994, 1.8087530136108398, 13.252492904663086, 4.363271713256836]}', 'coarse'), 
#            ('basin', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoMeth", "entity1_nn_chunk": "the GoM basin", "entity2_nn_chunk": "upstream", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.26, "entity2_attnscore": 0.09, "pair_attnscore": 0.13, "entity1_embedding": [5.8433122634887695, 4.126672744750977, 12.350343704223633, -1.7145037651062012, 1.3561350107192993, 5.465253829956055, 3.818899393081665, 6.0004096031188965, 4.371315956115723, -0.8875278830528259], "entity2_embedding": [4.564244270324707, 4.044623374938965, 11.257222175598145, -2.805084705352783, 0.5271148681640625, 5.256237030029297, 3.4214675426483154, 5.5007147789001465, 6.446624755859375, -0.2670416235923767], "sentence_embedding": [6.446906089782715, 4.911389350891113, 7.580166816711426, 5.830923557281494, 7.402199745178223, 3.9703714847564697, 0.7913414239883423, 1.881584644317627, 13.310700416564941, 4.403429985046387]}', 'upstream'), 
#            ('deposition', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "deposition", "entity2_nn_chunk": "a shale interval", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.26, "entity2_attnscore": 0.1, "pair_attnscore": 0.14, "entity1_embedding": [5.829537391662598, 3.618683099746704, 11.866701126098633, -2.3713107109069824, 0.753071129322052, 5.593186378479004, 4.517818927764893, 6.2818450927734375, 4.946016788482666, -1.8549760580062866], "entity2_embedding": [5.837291717529297, 3.606228828430176, 12.169337272644043, -2.4923853874206543, 1.2454801797866821, 5.570046901702881, 4.12644100189209, 6.067013740539551, 4.271209239959717, -1.8580063581466675], "sentence_embedding": [6.545234680175781, 4.814426422119141, 7.678420543670654, 5.73076057434082, 7.465472221374512, 3.9088425636291504, 0.7239596843719482, 1.8261140584945679, 13.319722175598145, 4.503015518188477]}', 'shale'), 
#            ('deposition', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "deposition", "entity2_nn_chunk": "coarse-grained terrigenous material", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.26, "entity2_attnscore": 0.05, "pair_attnscore": 0.09, "entity1_embedding": [5.681617259979248, 3.7610738277435303, 11.696586608886719, -2.4213547706604004, 0.8093734383583069, 5.434947967529297, 4.27480936050415, 6.225118160247803, 4.981009006500244, -2.3093111515045166], "entity2_embedding": [5.951302528381348, 3.3511581420898438, 12.633187294006348, -3.1682252883911133, 1.3989030122756958, 5.365297794342041, 4.025422096252441, 5.875014781951904, 5.1854753494262695, -1.0503737926483154], "sentence_embedding": [6.553924560546875, 4.805810451507568, 7.687103748321533, 5.721926689147949, 7.456376075744629, 3.9177052974700928, 0.7341960668563843, 1.8338223695755005, 13.306811332702637, 4.449173927307129]}', 'coarse'), 
#            ('deposition', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoMeth", "entity1_nn_chunk": "deposition", "entity2_nn_chunk": "upstream", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.26, "entity2_attnscore": 0.09, "pair_attnscore": 0.13, "entity1_embedding": [6.076726913452148, 3.362182855606079, 11.641417503356934, -2.2848501205444336, 0.6529626846313477, 5.650737762451172, 4.7267913818359375, 6.302373886108398, 5.2530927658081055, -1.543790578842163], "entity2_embedding": [4.2875213623046875, 4.0385847091674805, 10.988523483276367, -2.706702947616577, 0.5339958071708679, 5.201122760772705, 3.2895238399505615, 5.4339189529418945, 5.907756805419922, -0.5362511277198792], "sentence_embedding": [6.501481533050537, 4.857552528381348, 7.634706020355225, 5.7753424644470215, 7.433289527893066, 3.9401445388793945, 0.7584922313690186, 1.8542022705078125, 13.289820671081543, 4.459069728851318]}', 'upstream'), 
#            ('shale', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "a shale interval", "entity2_nn_chunk": "coarse-grained terrigenous material", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.1, "entity2_attnscore": 0.05, "pair_attnscore": 0.07, "entity1_embedding": [5.9977874755859375, 3.7346246242523193, 12.676517486572266, -2.3250181674957275, 1.0431196689605713, 5.351781845092773, 3.893080234527588, 6.132966995239258, 4.7821125984191895, -1.7701236009597778], "entity2_embedding": [6.1602277755737305, 3.374155282974243, 12.242295265197754, -3.5205886363983154, 1.1752307415008545, 5.2536468505859375, 4.057315826416016, 6.160139083862305, 5.165937423706055, -0.9953269362449646], "sentence_embedding": [6.469077110290527, 4.889509677886963, 7.602322578430176, 5.808347225189209, 7.420849323272705, 3.9522504806518555, 0.7720848321914673, 1.8649356365203857, 13.519695281982422, 4.446568489074707]}', 'coarse'), 
#            ('shale', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoMeth", "entity1_nn_chunk": "a shale interval", "entity2_nn_chunk": "upstream", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.1, "entity2_attnscore": 0.09, "pair_attnscore": 0.09, "entity1_embedding": [6.063595294952393, 3.8044660091400146, 12.22580623626709, -2.5579116344451904, 1.272342324256897, 5.412155628204346, 3.8483428955078125, 6.335390567779541, 5.1152753829956055, -1.904000163078308], "entity2_embedding": [4.703537464141846, 3.9003067016601562, 11.106224060058594, -2.797130584716797, 0.5926814079284668, 5.321666717529297, 3.484921455383301, 5.695457458496094, 6.652448654174805, -0.5294182896614075], "sentence_embedding": [6.519032001495361, 4.8403000831604, 7.652243614196777, 5.757435321807861, 7.378135681152344, 3.993770122528076, 0.8170480728149414, 1.9026448726654053, 13.366411209106445, 4.594491481781006]}', 'upstream'), 
#            ('coarse', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoMeth", "entity1_nn_chunk": "coarse-grained terrigenous material", "entity2_nn_chunk": "upstream", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.05, "entity2_attnscore": 0.09, "pair_attnscore": 0.07, "entity1_embedding": [6.035366535186768, 3.2941770553588867, 12.372620582580566, -3.0730860233306885, 1.2941354513168335, 5.303248882293701, 4.1046462059021, 6.088476657867432, 5.084489345550537, -1.149646520614624], "entity2_embedding": [4.340002059936523, 4.093116760253906, 10.948416709899902, -2.8529675006866455, 0.4779970943927765, 5.18277645111084, 3.2526495456695557, 5.588265419006348, 6.107642650604248, -0.4739149212837219], "sentence_embedding": [6.5594072341918945, 4.800396919250488, 7.692577362060547, 5.7163543701171875, 7.44279146194458, 3.9309427738189697, 0.7496019601821899, 1.8452762365341187, 13.276224136352539, 4.433037281036377]}', 'upstream'), 
#            ('upstream', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoMeth", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "upstream", "entity2_nn_chunk": "a particularly thick sedimentary section", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.09, "entity2_attnscore": 0.32, "pair_attnscore": 0.14, "entity1_embedding": [4.026890277862549, 3.9708030223846436, 10.976856231689453, -2.7027335166931152, 0.7182179689407349, 5.146567344665527, 3.5017364025115967, 6.1801676750183105, 6.400351524353027, -0.4934421479701996], "entity2_embedding": [5.2513532638549805, 4.0382866859436035, 12.682100296020508, -2.5550649166107178, 1.5109694004058838, 5.063141822814941, 3.9043688774108887, 5.6533966064453125, 5.512178897857666, -0.6867499947547913], "sentence_embedding": [6.4613213539123535, 4.897133827209473, 7.594571113586426, 5.816256523132324, 7.411578178405762, 3.9612784385681152, 0.7819844484329224, 1.873065710067749, 13.380748748779297, 4.526547908782959]}', 'sedimentary'), 
#            ('sedimentary', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 0.87, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro, I-GeoPetro", "entity1_nn_chunk": "a particularly thick sedimentary section", "entity2_nn_chunk": "the deep-sea fans", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.32, "entity2_attnscore": 0.12, "pair_attnscore": 0.17, "entity1_embedding": [5.223557949066162, 3.8352153301239014, 12.937973022460938, -2.729471206665039, 1.3154841661453247, 5.033245086669922, 3.7341718673706055, 6.027478218078613, 5.604751110076904, -1.0124191045761108], "entity2_embedding": [6.155776500701904, 4.468159198760986, 11.226419448852539, -2.4550249576568604, 1.140851616859436, 5.037225723266602, 3.9635696411132812, 6.92983341217041, 4.118157386779785, -0.10755118727684021], "sentence_embedding": [6.493762969970703, 4.8651251792907715, 7.626999378204346, 5.783196926116943, 7.430185794830322, 3.943176507949829, 0.7623773217201233, 1.8566397428512573, 13.31695556640625, 4.447195053100586]}', 'sea')]


triples = [('eocene', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM.", "entity1_score": 1.0, "entity2_score": 0.69, "entity1_label": "B-GeoTime, B-GeoMeth", "entity2_label": "B-GeoMeth", "entity1_nn_chunk": "a Paleocene\\u2013Eocene Thermal Maximum (PETM) record", "entity2_nn_chunk": "a 543-m-thick (1780 ft) deep-marine section", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.2, "entity2_attnscore": 0.09, "pair_attnscore": 0.12, "entity1_embedding": [2.7497622966766357, -0.5454338788986206, 6.291350364685059, 8.717966079711914, 3.0895700454711914, 2.3901493549346924, 2.462153673171997, 2.4761993885040283, 3.185384511947632, 12.142127990722656], "entity2_embedding": [3.7323296070098877, -1.4545331001281738, 6.134968280792236, 8.18924331665039, 2.7829885482788086, 4.156617164611816, 1.9409900903701782, 2.868553876876831, 4.041325569152832, 13.211334228515625], "sentence_embedding": [8.273744583129883, 2.051804780960083, 9.59654426574707, -2.3267648220062256, 9.436607360839844, 10.587993621826172, -7.340267181396484, 4.733699321746826, 5.80666971206665, 5.723113536834717]}', 'ft'), 
           ('eocene', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM.", "entity1_score": 1.0, "entity2_score": 0.92, "entity1_label": "B-GeoTime, B-GeoMeth", "entity2_label": "B-GeoLoc", "entity1_nn_chunk": "a Paleocene\\u2013Eocene Thermal Maximum (PETM) record", "entity2_nn_chunk": "Mexico", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.2, "entity2_attnscore": 0.09, "pair_attnscore": 0.13, "entity1_embedding": [2.6488053798675537, -0.6798055768013, 6.543962478637695, 8.325488090515137, 3.091782331466675, 2.573601722717285, 2.505544900894165, 2.2582333087921143, 3.1716434955596924, 12.096002578735352], "entity2_embedding": [3.2900171279907227, -3.1185624599456787, 6.074228286743164, 8.012141227722168, 2.4355814456939697, 3.655385732650757, 2.7318809032440186, 2.2702815532684326, 3.1232528686523438, 12.755410194396973], "sentence_embedding": [8.274189949035645, 2.051741600036621, 9.596600532531738, -2.326831579208374, 9.588064193725586, 10.738533973693848, -7.178147792816162, 4.895790100097656, 5.51309061050415, 5.5418500900268555]}', 'mexico'), 
           ('eocene', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM.", "entity1_score": 1.0, "entity2_score": 0.98, "entity1_label": "B-GeoTime, B-GeoMeth", "entity2_label": "B-GeoMeth, B-GeoPetro", "entity1_nn_chunk": "a Paleocene\\u2013Eocene Thermal Maximum (PETM) record", "entity2_nn_chunk": "organic carbon stable isotopes", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.2, "entity2_attnscore": 0.21, "pair_attnscore": 0.21, "entity1_embedding": [2.792264461517334, -0.5597057938575745, 6.471883773803711, 8.395708084106445, 3.065075159072876, 2.7189583778381348, 2.3715662956237793, 2.3874168395996094, 3.2599542140960693, 12.358487129211426], "entity2_embedding": [3.6428165435791016, -0.1321650743484497, 5.9235968589782715, 8.318928718566895, 2.0116961002349854, 2.7097012996673584, 2.3251116275787354, 2.9655239582061768, 2.381112813949585, 11.753918647766113], "sentence_embedding": [8.273637771606445, 2.0518276691436768, 9.596525192260742, -2.3267481327056885, 9.410528182983398, 10.562018394470215, -7.365957736968994, 4.708027362823486, 5.797874927520752, 5.788640975952148]}', 'organic'), 
           ('ft', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM.", "entity1_score": 0.69, "entity2_score": 0.92, "entity1_label": "B-GeoMeth", "entity2_label": "B-GeoLoc", "entity1_nn_chunk": "a 543-m-thick (1780 ft) deep-marine section", "entity2_nn_chunk": "Mexico", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.09, "entity2_attnscore": 0.09, "pair_attnscore": 0.09, "entity1_embedding": [3.9145333766937256, -1.3819427490234375, 6.232261657714844, 7.93341064453125, 3.304962635040283, 3.6077494621276855, 1.7642797231674194, 2.5056090354919434, 4.156083106994629, 12.344873428344727], "entity2_embedding": [3.252547025680542, -2.6739959716796875, 6.196337699890137, 7.94928503036499, 2.37715482711792, 3.465878486633301, 2.636854887008667, 2.277503728866577, 2.9351625442504883, 13.037396430969238], "sentence_embedding": [8.273326873779297, 2.0518717765808105, 9.596479415893555, -2.326699733734131, 9.342904090881348, 10.494515419006348, -7.430538177490234, 4.64348030090332, 5.878793239593506, 5.812100410461426]}', 'mexico'), 
           ('ft', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM.", "entity1_score": 0.69, "entity2_score": 0.98, "entity1_label": "B-GeoMeth", "entity2_label": "B-GeoMeth, B-GeoPetro", "entity1_nn_chunk": "a 543-m-thick (1780 ft) deep-marine section", "entity2_nn_chunk": "organic carbon stable isotopes", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.09, "entity2_attnscore": 0.21, "pair_attnscore": 0.12, "entity1_embedding": [3.72121262550354, -1.2197364568710327, 6.335819244384766, 7.918046474456787, 3.3196980953216553, 4.441747665405273, 1.680811882019043, 2.783958673477173, 3.540374994277954, 12.884989738464355], "entity2_embedding": [3.5021800994873047, -0.06335429102182388, 5.944340229034424, 8.448829650878906, 1.9487491846084595, 2.593893527984619, 2.2817087173461914, 3.0285210609436035, 2.276712417602539, 11.722785949707031], "sentence_embedding": [8.273797035217285, 2.0517985820770264, 9.596549987792969, -2.3267695903778076, 9.452091217041016, 10.603425979614258, -7.32454776763916, 4.7494096755981445, 5.788027763366699, 5.748314380645752]}', 'organic'),
           ('mexico', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM.", "entity1_score": 0.92, "entity2_score": 0.98, "entity1_label": "B-GeoLoc", "entity2_label": "B-GeoMeth, B-GeoPetro", "entity1_nn_chunk": "Mexico", "entity2_nn_chunk": "organic carbon stable isotopes", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.09, "entity2_attnscore": 0.21, "pair_attnscore": 0.13, "entity1_embedding": [3.144767999649048, -2.7147321701049805, 6.127165794372559, 8.295948028564453, 2.8409361839294434, 3.421802282333374, 2.720162868499756, 1.9653069972991943, 3.038386106491089, 12.980123519897461], "entity2_embedding": [3.5817856788635254, -0.024259988218545914, 5.900996208190918, 8.518841743469238, 2.084223985671997, 2.620420455932617, 2.407585859298706, 3.089611768722534, 2.2546801567077637, 11.82196044921875], "sentence_embedding": [8.273309707641602, 2.051867723464966, 9.596478462219238, -2.3266983032226562, 9.337979316711426, 10.48964786529541, -7.436363697052002, 4.637650012969971, 5.869350433349609, 5.816451072692871]}', 'organic'), 
           ('tectonic', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoMeth", "entity1_nn_chunk": "tectonic perturbations", "entity2_nn_chunk": "the upstream North American catchments", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.25, "entity2_attnscore": 0.11, "pair_attnscore": 0.15, "entity1_embedding": [3.6411795616149902, -1.5020869970321655, 5.696325778961182, 8.604700088500977, 1.5151718854904175, 3.677309274673462, 2.884289264678955, 2.873039484024048, 1.5940958261489868, 11.50014591217041], "entity2_embedding": [3.9356887340545654, -0.4274052679538727, 6.138661861419678, 8.16846752166748, 2.308915376663208, 4.314570426940918, 1.8623437881469727, 3.321876049041748, 3.1112611293792725, 12.501526832580566], "sentence_embedding": [8.273104667663574, 2.0518875122070312, 9.596617698669434, -2.3267197608947754, 7.928299903869629, 9.09572696685791, -9.138922691345215, 2.935373067855835, 4.520363807678223, 4.727715015411377]}', 'upstream'), 
           ('tectonic', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "tectonic perturbations", "entity2_nn_chunk": "the downstream sectors", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.25, "entity2_attnscore": 0.49, "pair_attnscore": 0.33, "entity1_embedding": [3.85038685798645, -1.3444548845291138, 5.504477024078369, 8.894646644592285, 1.6295241117477417, 3.37282395362854, 2.5772287845611572, 3.101915121078491, 1.5097862482070923, 11.506526947021484], "entity2_embedding": [3.9193172454833984, -1.6295044422149658, 5.632161617279053, 7.854856967926025, 1.1065350770950317, 2.7394042015075684, 2.5630269050598145, 2.9742021560668945, 1.9695501327514648, 11.684067726135254], "sentence_embedding": [8.274432182312012, 2.051668167114258, 9.596901893615723, -2.3269529342651367, 7.91616678237915, 9.085306167602539, -9.196913719177246, 2.8773529529571533, 4.365344524383545, 4.512395858764648]}', 'downstream'), 
           ('tectonic', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin.", "entity1_score": 1.0, "entity2_score": 0.98, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "tectonic perturbations", "entity2_nn_chunk": "the Gulf Coastal Plain", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.25, "entity2_attnscore": 0.24, "pair_attnscore": 0.24, "entity1_embedding": [3.5848329067230225, -1.487343668937683, 5.6952009201049805, 8.473453521728516, 1.5355619192123413, 3.6111767292022705, 2.654287099838257, 3.0325963497161865, 1.4424744844436646, 11.632696151733398], "entity2_embedding": [4.40934944152832, -2.6414687633514404, 5.719301700592041, 8.166884422302246, 1.9718804359436035, 3.195392608642578, 2.2786951065063477, 2.728088140487671, 3.600144386291504, 12.685139656066895], "sentence_embedding": [8.171407699584961, 2.0686159133911133, 9.576199531555176, -2.308645725250244, 8.752703666687012, 9.852017402648926, -7.976686954498291, 4.097899436950684, 2.8626537322998047, 3.544607162475586]}', 'coastal'), 
           ('upstream', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoMeth", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "the upstream North American catchments", "entity2_nn_chunk": "the downstream sectors", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.11, "entity2_attnscore": 0.49, "pair_attnscore": 0.18, "entity1_embedding": [3.781593084335327, -0.8344725370407104, 6.194002151489258, 8.271034240722656, 2.546635389328003, 4.471875190734863, 1.8119113445281982, 3.2294750213623047, 2.757159471511841, 12.193735122680664], "entity2_embedding": [4.007772922515869, -1.539210557937622, 5.661635398864746, 7.687388896942139, 1.4495539665222168, 2.722914934158325, 2.4864203929901123, 2.8783230781555176, 2.188131809234619, 11.470794677734375], "sentence_embedding": [8.274091720581055, 2.0517280101776123, 9.596802711486816, -2.3268887996673584, 7.976433277130127, 9.145756721496582, -9.147445678710938, 2.926783561706543, 4.40964412689209, 4.408041000366211]}', 'downstream'), 
           ('upstream', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin.", "entity1_score": 1.0, "entity2_score": 0.98, "entity1_label": "B-GeoMeth", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "the upstream North American catchments", "entity2_nn_chunk": "the Gulf Coastal Plain", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.11, "entity2_attnscore": 0.24, "pair_attnscore": 0.15, "entity1_embedding": [3.7742319107055664, -0.7761141657829285, 6.207308769226074, 8.10714340209961, 2.6537845134735107, 4.6391167640686035, 1.713283658027649, 3.2407264709472656, 3.028916597366333, 12.314061164855957], "entity2_embedding": [4.119009494781494, -2.451376438140869, 5.714200496673584, 8.16775131225586, 1.5697892904281616, 3.016974449157715, 2.3051607608795166, 2.6763205528259277, 4.043854236602783, 12.48615837097168], "sentence_embedding": [8.274133682250977, 2.0517232418060303, 9.596816062927246, -2.326892375946045, 7.954324722290039, 9.124204635620117, -9.18288803100586, 2.8913755416870117, 4.316779613494873, 4.332244873046875]}', 'coastal'), 
           ('downstream', '{"context": "In this study, we present evidence of a Paleocene\\u2013Eocene Thermal Maximum (PETM) record within a 543-m-thick (1780 ft) deep-marine section in the Gulf of Mexico (GoM) using organic carbon stable isotopes and biostratigraphic constraints. We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin.", "entity1_score": 1.0, "entity2_score": 0.98, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "the downstream sectors", "entity2_nn_chunk": "the Gulf Coastal Plain", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.49, "entity2_attnscore": 0.24, "pair_attnscore": 0.32, "entity1_embedding": [3.9212284088134766, -1.6629095077514648, 5.521124362945557, 7.751332759857178, 1.503126621246338, 2.7465665340423584, 2.5462348461151123, 2.9435184001922607, 1.9544049501419067, 11.384193420410156], "entity2_embedding": [3.904635190963745, -2.3259449005126953, 5.728708267211914, 8.567526817321777, 1.8445405960083008, 3.1008949279785156, 2.3495540618896484, 2.6896140575408936, 4.384907245635986, 12.416000366210938], "sentence_embedding": [8.274145126342773, 2.0517215728759766, 9.59683609008789, -2.3269004821777344, 7.935454845428467, 9.104917526245117, -9.188153266906738, 2.8860979080200195, 4.3856353759765625, 4.518765926361084]}', 'coastal'), 
           ('basin', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "the GoM basin", "entity2_nn_chunk": "deposition", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.26, "entity2_attnscore": 0.26, "pair_attnscore": 0.26, "entity1_embedding": [3.779275417327881, -2.450312376022339, 5.564785957336426, 9.048267364501953, 1.158644199371338, 2.5670621395111084, 2.868556499481201, 2.8476035594940186, 2.626718044281006, 11.972245216369629], "entity2_embedding": [3.8690717220306396, -1.558268427848816, 5.745287895202637, 8.37027359008789, 1.8900668621063232, 2.226731777191162, 2.4036779403686523, 2.7072699069976807, 1.3761074542999268, 11.92121410369873], "sentence_embedding": [8.26048469543457, 2.0539541244506836, 9.59400463104248, -2.3245110511779785, 8.029595375061035, 9.17389965057373, -8.415410041809082, 3.659198522567749, 3.3177754878997803, 3.4890079498291016]}', 'deposition'), 
           ('basin', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "the GoM basin", "entity2_nn_chunk": "a shale interval", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.26, "entity2_attnscore": 0.1, "pair_attnscore": 0.14, "entity1_embedding": [4.119443416595459, -2.4170005321502686, 5.506854057312012, 8.978416442871094, 1.1511424779891968, 2.5173678398132324, 2.7195496559143066, 2.852993965148926, 2.2741880416870117, 12.252689361572266], "entity2_embedding": [3.9250998497009277, -0.9356150031089783, 5.388732433319092, 9.552205085754395, 1.5140143632888794, 2.5319619178771973, 2.372610330581665, 3.2776687145233154, 1.8205068111419678, 12.066429138183594], "sentence_embedding": [8.265246391296387, 2.0531725883483887, 9.594969749450684, -2.3253417015075684, 8.152375221252441, 9.298916816711426, -8.365521430969238, 3.7090201377868652, 3.5349483489990234, 3.0754904747009277]}', 'shale'), 
           ('basin', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "the GoM basin", "entity2_nn_chunk": "coarse-grained terrigenous material", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.26, "entity2_attnscore": 0.05, "pair_attnscore": 0.09, "entity1_embedding": [4.108553409576416, -2.4838831424713135, 5.380271911621094, 9.477745056152344, 1.5617849826812744, 2.5357635021209717, 2.673309564590454, 2.7784769535064697, 2.1955718994140625, 12.205521583557129], "entity2_embedding": [4.0050835609436035, -1.1028891801834106, 5.440834045410156, 9.748600959777832, 1.7639741897583008, 2.5701112747192383, 2.4116194248199463, 2.9646735191345215, 2.2542827129364014, 11.504647254943848], "sentence_embedding": [8.258162498474121, 2.0543270111083984, 9.593584060668945, -2.324106454849243, 7.6216044425964355, 8.752443313598633, -8.413619995117188, 3.6613075733184814, 3.641577959060669, 3.4947078227996826]}', 'coarse'), 
           ('basin', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoMeth", "entity1_nn_chunk": "the GoM basin", "entity2_nn_chunk": "upstream", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.26, "entity2_attnscore": 0.09, "pair_attnscore": 0.13, "entity1_embedding": [3.736577033996582, -2.4790451526641846, 5.554500102996826, 9.023608207702637, 1.1513177156448364, 2.42797589302063, 2.8700180053710938, 2.8867266178131104, 2.2713053226470947, 12.193184852600098], "entity2_embedding": [3.824883222579956, -0.5760443806648254, 6.2958478927612305, 8.043895721435547, 2.6064090728759766, 4.462185382843018, 1.701485276222229, 3.265139102935791, 2.85941743850708, 12.199705123901367], "sentence_embedding": [8.258600234985352, 2.0542502403259277, 9.593637466430664, -2.3241846561431885, 7.877345085144043, 9.01498031616211, -8.370376586914062, 3.704374074935913, 3.5215251445770264, 3.322709083557129]}', 'upstream'), 
           ('deposition', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "deposition", "entity2_nn_chunk": "a shale interval", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.26, "entity2_attnscore": 0.1, "pair_attnscore": 0.14, "entity1_embedding": [4.037097454071045, -1.5482368469238281, 5.687910079956055, 8.639769554138184, 2.0061299800872803, 2.580061912536621, 2.3091812133789062, 2.835251808166504, 0.9321686029434204, 11.964442253112793], "entity2_embedding": [3.823697328567505, -0.8554319143295288, 5.418757915496826, 9.303988456726074, 1.4667565822601318, 2.4567506313323975, 2.3202929496765137, 3.2809736728668213, 1.8063433170318604, 12.352104187011719], "sentence_embedding": [8.265887260437012, 2.0530619621276855, 9.595108985900879, -2.325455904006958, 8.23084545135498, 9.379379272460938, -8.350030899047852, 3.7244553565979004, 3.357015609741211, 3.0107994079589844]}', 'shale'), 
           ('deposition', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "deposition", "entity2_nn_chunk": "coarse-grained terrigenous material", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.26, "entity2_attnscore": 0.05, "pair_attnscore": 0.09, "entity1_embedding": [4.022927761077881, -1.2513703107833862, 5.67182731628418, 8.537543296813965, 1.5244730710983276, 2.4617042541503906, 2.345921516418457, 3.041199207305908, 1.4364830255508423, 11.754050254821777], "entity2_embedding": [4.1893534660339355, -0.9747512936592102, 5.430134296417236, 9.750176429748535, 1.9102195501327515, 2.4549989700317383, 2.4048633575439453, 2.9038901329040527, 2.405259132385254, 11.941838264465332], "sentence_embedding": [8.260772705078125, 2.053903579711914, 9.594109535217285, -2.324568748474121, 7.807742595672607, 8.947274208068848, -8.485549926757812, 3.589221954345703, 3.6893534660339355, 3.214524030685425]}', 'coarse'), 
           ('deposition', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoMeth", "entity1_nn_chunk": "deposition", "entity2_nn_chunk": "upstream", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.26, "entity2_attnscore": 0.09, "pair_attnscore": 0.13, "entity1_embedding": [4.127425193786621, -1.5212538242340088, 5.6802496910095215, 8.361967086791992, 1.9768118858337402, 2.3448410034179688, 2.362427234649658, 2.735774278640747, 1.5828312635421753, 11.465723037719727], "entity2_embedding": [4.109014511108398, -0.7797077894210815, 6.112752437591553, 8.394779205322266, 2.451874017715454, 4.320161819458008, 1.620858907699585, 3.317976236343384, 2.830693483352661, 12.318888664245605], "sentence_embedding": [8.26502513885498, 2.053211212158203, 9.594893455505371, -2.3252992630004883, 8.202630043029785, 9.348957061767578, -8.314787864685059, 3.7597386837005615, 3.485481023788452, 3.1397032737731934]}', 'upstream'), 
           ('shale', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "a shale interval", "entity2_nn_chunk": "coarse-grained terrigenous material", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.1, "entity2_attnscore": 0.05, "pair_attnscore": 0.07, "entity1_embedding": [3.8545055389404297, -1.1383901834487915, 5.378453731536865, 9.810062408447266, 1.592409610748291, 2.8200225830078125, 2.433525562286377, 3.1255710124969482, 1.8716100454330444, 11.913195610046387], "entity2_embedding": [4.333093643188477, -0.8805223703384399, 5.475193977355957, 9.671239852905273, 2.063199520111084, 2.3700921535491943, 2.3002822399139404, 2.8283228874206543, 2.4080417156219482, 11.918879508972168], "sentence_embedding": [8.267016410827637, 2.052884101867676, 9.595311164855957, -2.325650453567505, 8.268800735473633, 9.418998718261719, -8.360254287719727, 3.714193344116211, 3.7852654457092285, 2.7610220909118652]}', 'coarse'), 
           ('shale', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoMeth", "entity1_nn_chunk": "a shale interval", "entity2_nn_chunk": "upstream", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.1, "entity2_attnscore": 0.09, "pair_attnscore": 0.09, "entity1_embedding": [3.913846731185913, -1.3515106439590454, 5.415563583374023, 9.736641883850098, 1.5567667484283447, 2.753096342086792, 2.371159076690674, 3.108031749725342, 1.6675533056259155, 12.004403114318848], "entity2_embedding": [3.9803621768951416, -0.6945693492889404, 6.077136993408203, 8.257105827331543, 2.2994720935821533, 4.3783793449401855, 1.7453073263168335, 3.397482395172119, 2.9937987327575684, 12.354580879211426], "sentence_embedding": [8.26601505279541, 2.053044557571411, 9.595142364501953, -2.32547926902771, 8.163567543029785, 9.313164710998535, -8.43984317779541, 3.634657859802246, 3.6852385997772217, 2.86068058013916]}', 'upstream'), 
           ('coarse', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoMeth", "entity1_nn_chunk": "coarse-grained terrigenous material", "entity2_nn_chunk": "upstream", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.05, "entity2_attnscore": 0.09, "pair_attnscore": 0.07, "entity1_embedding": [4.183037757873535, -0.95732182264328, 5.360871315002441, 10.020729064941406, 1.9280916452407837, 2.735372543334961, 2.475790023803711, 2.884106159210205, 2.3718998432159424, 11.750289916992188], "entity2_embedding": [4.050603866577148, -0.688696563243866, 6.089183807373047, 8.378361701965332, 2.33626127243042, 4.648577690124512, 1.70479416847229, 3.407353639602661, 3.1088290214538574, 12.333937644958496], "sentence_embedding": [8.26403522491455, 2.0533668994903564, 9.594727516174316, -2.3251283168792725, 8.122334480285645, 9.268819808959961, -8.390889167785645, 3.683662176132202, 3.695371150970459, 3.024846076965332]}', 'upstream'), 
           ('upstream', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 1.0, "entity1_label": "B-GeoMeth", "entity2_label": "B-GeoPetro", "entity1_nn_chunk": "upstream", "entity2_nn_chunk": "a particularly thick sedimentary section", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.09, "entity2_attnscore": 0.32, "pair_attnscore": 0.14, "entity1_embedding": [4.113377571105957, -0.4475870728492737, 6.095298767089844, 8.45187759399414, 2.4396491050720215, 4.143350601196289, 1.7025946378707886, 3.283315658569336, 2.8183791637420654, 12.168099403381348], "entity2_embedding": [4.4357590675354, -1.8888970613479614, 5.451931476593018, 9.404488563537598, 1.1754322052001953, 3.111313581466675, 2.1995394229888916, 3.109503746032715, 3.035334587097168, 12.325691223144531], "sentence_embedding": [8.266093254089355, 2.0530381202697754, 9.595128059387207, -2.3254902362823486, 8.218499183654785, 9.367105484008789, -8.362135887145996, 3.712357997894287, 3.6974105834960938, 2.9043288230895996]}', 'sedimentary'), 
           ('sedimentary', '{"context": "We suggest that climate and tectonic perturbations in the upstream North American catchments can induce a substantial response in the downstream sectors of the Gulf Coastal Plain and ultimately in the GoM. This relationship is illustrated in the deep-water basin by (1) a high accom- modation and deposition of a shale interval when coarse-grained terrigenous material was trapped upstream at the onset of the PETM, and (2) a considerable increase in sedi- ment supply during the PETM, which is archived as a particularly thick sedimentary section in the deep-sea fans of the GoM basin. Despite other thick PETM sections being observed elsewhere in the world, the one described in this study links with a continental- scale paleo-drainage, which makes it of particular interest for paleoclimate and source- to-sink reconstructions.", "entity1_score": 1.0, "entity2_score": 0.87, "entity1_label": "B-GeoPetro", "entity2_label": "B-GeoPetro, I-GeoPetro", "entity1_nn_chunk": "a particularly thick sedimentary section", "entity2_nn_chunk": "the deep-sea fans", "file_path": "dummy_1_file.txt", "entity1_attnscore": 0.32, "entity2_attnscore": 0.12, "pair_attnscore": 0.17, "entity1_embedding": [4.744527816772461, -1.797021508216858, 5.398539066314697, 9.334464073181152, 1.169188141822815, 3.1069962978363037, 2.099773645401001, 3.097820281982422, 2.888684034347534, 12.149800300598145], "entity2_embedding": [3.2142386436462402, -2.473020553588867, 5.727625846862793, 9.082856178283691, 2.1118242740631104, 2.521404266357422, 2.7171003818511963, 2.5763702392578125, 3.8491625785827637, 12.245673179626465], "sentence_embedding": [8.262020111083984, 2.053694725036621, 9.594340324401855, -2.3247909545898438, 7.908104419708252, 9.051258087158203, -8.493917465209961, 3.5807642936706543, 3.4950454235076904, 3.304839611053467]}', 'sea')]  
# Initialize the filter with thresholds
triple_filter = TripleFilter(
    score_threshold=0.6,
    attention_score_threshold=0.1,
    similarity_threshold=0.5,
    min_cluster_size=5,
    min_samples=3

)
# filtered_triples, reduction_count = triple_filter.filter_triples(triples)
# print(f"Filtered out {reduction_count} triples.")

clustered_triples, cluster_reduction_count, clusterer = triple_filter.cluster_triples(triples)
print(f"Clustered out {cluster_reduction_count} triples.")
print("clustered triples : ",clustered_triples)

#Assuming 'triples' is a list of triples you want to filter
filtered_triples, reduction_count = triple_filter.filter_triples(clustered_triples)
print(f"Filtered out {reduction_count} triples.")
print("filtered triples : ",filtered_triples)

